!function(){var e=function(e){this.audioElement=e||document.createElement("audio")};e.prototype.init=function(e){return this.loadUrl(e).then(function(e){this.audioElement.src=e,this.audioElement.play()}.bind(this))},e.prototype.loadUrl=function(e){return e.indexOf(".m3u")<0?Promise.resolve(e):new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.overrideMimeType("audio/x-mpegurl"),r.onload=function(){var r=M3U.parse(this.response);if(r.length>0){var i=r[0].file;t(i)}else n(new Error("Unable to load m3u at: "+e))},r.onerror=function(){n({status:this.status,statusText:r.statusText})},r.send()})},window.AgileAudioPlayer=e}();var COMMENT_RE,EXTENDED,comments,empty,extended,parse,simple;EXTENDED="#EXTM3U",COMMENT_RE=/:(?:(-?\d+),(.+)\s*-\s*(.+)|(.+))\n(.+)/,extended=function(e){var t;if(t=e.match(COMMENT_RE),t&&6===t.length)return{length:t[1]||0,artist:t[2]||"",title:t[4]||t[3],file:t[5].trim()}},simple=function(e){return{file:e.trim()}},empty=function(e){return!!e.trim().length},comments=function(e){return"#"!==e[0]},parse=function(e){var t;return e=e.replace(/\r/g,""),t=e.search("\n"),e.substr(0,t)===EXTENDED?e.substr(t).split("\n#").filter(empty).map(extended):e.split("\n").filter(empty).filter(comments).map(simple)},("undefined"!=typeof module&&null!==module?module.exports:window).M3U={name:"m3u",parse:parse};